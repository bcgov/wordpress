import{_ as e,c as s,e as n,o as t}from"./app-DCBtsDhP.js";const l={};function i(p,a){return t(),s("div",null,[...a[0]||(a[0]=[n(`<h1 id="deploying-wordpress-to-kubernetes" tabindex="-1"><a class="header-anchor" href="#deploying-wordpress-to-kubernetes"><span>Deploying WordPress to Kubernetes</span></a></h1><p><a href="https://kubectl.docs.kubernetes.io/" target="_blank" rel="noopener noreferrer">Kustomize</a> is a standalone tool to customize Kubernetes objects through a kustomization file, that ships with both OC and kubectl deployment utilities. To make local deployments more seamless, all images are being pulled from DockerHub <a href="https://hub.docker.com/?namespace=bcgovgdx" target="_blank" rel="noopener noreferrer">bcgovgdx namespace</a>, alternatively you can <a href="#building-images">build this images using docker build</a></p><h2 id="prerequisites" tabindex="-1"><a class="header-anchor" href="#prerequisites"><span>Prerequisites</span></a></h2><ul><li>Kubernetes cluster</li><li>Kubectl installed</li></ul><h2 id="deploy" tabindex="-1"><a class="header-anchor" href="#deploy"><span>Deploy</span></a></h2><div class="language-bash" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl apply <span class="token parameter variable">-k</span> ./deployments/kustomize/overlays/local</span>
<span class="line"></span></code></pre></div><h2 id="the-deployment" tabindex="-1"><a class="header-anchor" href="#the-deployment"><span>The Deployment</span></a></h2><ul><li>Your new site should be accessible at http://0.0.0.0:30080/</li><li>WordPress network sites can&#39;t be used due to the port restrictions.</li></ul><h3 id="access-the-sidecar" tabindex="-1"><a class="header-anchor" href="#access-the-sidecar"><span>Access the sidecar</span></a></h3><ul><li>Find the sidecar pod by running <code>kubectl get pods</code> then replace the pod name in the command.</li><li><code>kubectl exec -it pod/wordpress-sidecar-abcd -- bash</code></li><li>cd /var/www/html</li><li>you can now run <a href="https://wp-cli.org/" target="_blank" rel="noopener noreferrer">wp cli</a> commands, however locally this container is running in root so you will have to use the --allow-root flag</li><li>sample command <code>wp plugin list --allow-root</code></li></ul><h2 id="delete-deployment" tabindex="-1"><a class="header-anchor" href="#delete-deployment"><span>Delete Deployment</span></a></h2><div class="language-bash" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl delete <span class="token parameter variable">-k</span> ./deployments/kustomize/overlays/local</span>
<span class="line"></span></code></pre></div><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>This will delete all resources, including volumes</p></div><h2 id="building-images" tabindex="-1"><a class="header-anchor" href="#building-images"><span>Building Images</span></a></h2><h3 id="nginx" tabindex="-1"><a class="header-anchor" href="#nginx"><span>Nginx</span></a></h3><div class="language-bash" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Build the image</span></span>
<span class="line"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> bcgovgdx/wordpress-nginx-run <span class="token punctuation">\\</span></span>
<span class="line">            <span class="token parameter variable">-f</span> openshift/templates/images/nginx/docker/Dockerfile <span class="token punctuation">\\</span></span>
<span class="line">            ./openshift/templates/images/nginx/docker</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Verify image</span></span>
<span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-it</span> bcgovgdx/wordpress-nginx-run <span class="token function">sh</span></span>
<span class="line"></span></code></pre></div><h3 id="mariadb" tabindex="-1"><a class="header-anchor" href="#mariadb"><span>MariaDB</span></a></h3><div class="language-bash" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Build the image</span></span>
<span class="line"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> bcgovgdx/wordpress-mariadb-run <span class="token punctuation">\\</span></span>
<span class="line">            <span class="token parameter variable">-f</span> openshift/templates/images/mariadb/docker/Dockerfile <span class="token punctuation">\\</span></span>
<span class="line">            ./openshift/templates/images/mariadb/docker</span>
<span class="line"></span></code></pre></div><h3 id="wordpress" tabindex="-1"><a class="header-anchor" href="#wordpress"><span>WordPress</span></a></h3><div class="language-bash" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Build the image</span></span>
<span class="line"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> bcgovgdx/wordpress-wordpress-run <span class="token punctuation">\\</span></span>
<span class="line">            <span class="token parameter variable">-f</span> openshift/templates/images/wordpress/docker/Dockerfile <span class="token punctuation">\\</span></span>
<span class="line">            ./openshift/templates/images/wordpress/docker</span>
<span class="line"></span></code></pre></div><h3 id="sidecar" tabindex="-1"><a class="header-anchor" href="#sidecar"><span>Sidecar</span></a></h3><div class="language-bash" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Build the image</span></span>
<span class="line"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> bcgovgdx/wordpress-sidecar-run <span class="token punctuation">\\</span></span>
<span class="line">            <span class="token parameter variable">-f</span> openshift/templates/images/sidecar/docker/Dockerfile <span class="token punctuation">\\</span></span>
<span class="line">            ./openshift/templates/images/sidecar/docker</span>
<span class="line"></span></code></pre></div><h3 id="plugin-themes" tabindex="-1"><a class="header-anchor" href="#plugin-themes"><span>Plugin / themes</span></a></h3><div class="language-bash" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Build the image</span></span>
<span class="line"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> bcgovgdx/wordpress-plugins-themes <span class="token punctuation">\\</span></span>
<span class="line">            <span class="token parameter variable">-f</span> openshift/templates/images/plugins_themes/Dockerfile <span class="token punctuation">\\</span></span>
<span class="line">            ./openshift/templates/images/plugins_themes/</span>
<span class="line"></span></code></pre></div><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>Images that come from <a href="https://hub.docker.com/search?q=bcgovgdx" target="_blank" rel="noopener noreferrer">bcgovgdx namespace</a> should <strong>NOT</strong> be used in production deployments.</p></div><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>All commands are given from the root of this repository</p></div>`,26)])])}const o=e(l,[["render",i]]),c=JSON.parse('{"path":"/guide/GettingStarted/deploy_kubernetes.html","title":"Deploying WordPress to Kubernetes","lang":"en-US","frontmatter":{},"git":{"contributors":[{"name":"ShawnTurple","username":"ShawnTurple","email":"45861534+ShawnTurple@users.noreply.github.com","commits":1,"url":"https://github.com/ShawnTurple"}],"changelog":[{"hash":"15a12f29942a2cf16ad9aa2931dc65a9a4041e86","time":1756162517000,"email":"45861534+ShawnTurple@users.noreply.github.com","author":"Shawn","message":"Merge pull request #87 from bcgov/feature/descw-3157-add-wpcli-docs-alternative-local-deploy"}]},"filePathRelative":"guide/GettingStarted/deploy_kubernetes.md"}');export{o as comp,c as data};
