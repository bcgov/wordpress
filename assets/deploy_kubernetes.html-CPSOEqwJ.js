import{_ as l,r as i,o,c as r,a as e,b as s,d as n,e as t}from"./app-CJU2Ihug.js";const c={},d=e("h1",{id:"deploying-wordpress-to-kubernetes",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#deploying-wordpress-to-kubernetes"},[e("span",null,"Deploying WordPress to Kubernetes")])],-1),p={href:"https://kubectl.docs.kubernetes.io/",target:"_blank",rel:"noopener noreferrer"},h={href:"https://hub.docker.com/?namespace=bcgovgdx",target:"_blank",rel:"noopener noreferrer"},u=e("a",{href:"#building-images"},"build this images using docker build",-1),m=t(`<h2 id="prerequisites" tabindex="-1"><a class="header-anchor" href="#prerequisites"><span>Prerequisites</span></a></h2><ul><li>Kubernetes cluster</li><li>Kubectl installed</li></ul><h2 id="deploy" tabindex="-1"><a class="header-anchor" href="#deploy"><span>Deploy</span></a></h2><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl apply <span class="token parameter variable">-k</span> ./deployments/kustomize/overlays/local
</code></pre></div><h2 id="the-deployment" tabindex="-1"><a class="header-anchor" href="#the-deployment"><span>The Deployment</span></a></h2><ul><li>Your new site should be accessible at http://0.0.0.0:30080/</li><li>WordPress network sites can&#39;t be used due to the port restrictions.</li></ul><h3 id="access-the-sidecar" tabindex="-1"><a class="header-anchor" href="#access-the-sidecar"><span>Access the sidecar</span></a></h3>`,7),g=e("li",null,[s("Find the sidecar pod by running "),e("code",null,"kubectl get pods"),s(" then replace the pod name in the command.")],-1),b=e("li",null,[e("code",null,"kubectl exec -it pod/wordpress-sidecar-abcd -- bash")],-1),k=e("li",null,"cd /var/www/html",-1),v={href:"https://wp-cli.org/",target:"_blank",rel:"noopener noreferrer"},f=e("li",null,[s("sample command "),e("code",null,"wp plugin list --allow-root")],-1),_=t(`<h2 id="delete-deployment" tabindex="-1"><a class="header-anchor" href="#delete-deployment"><span>Delete Deployment</span></a></h2><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl delete <span class="token parameter variable">-k</span> ./deployments/kustomize/overlays/local
</code></pre></div><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>This will delete all resources, including volumes</p></div><h2 id="building-images" tabindex="-1"><a class="header-anchor" href="#building-images"><span>Building Images</span></a></h2><h3 id="nginx" tabindex="-1"><a class="header-anchor" href="#nginx"><span>Nginx</span></a></h3><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># Build the image</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span> bcgovgdx/wordpress-nginx-run <span class="token punctuation">\\</span>
            <span class="token parameter variable">-f</span> openshift/templates/images/nginx/docker/Dockerfile <span class="token punctuation">\\</span>
            ./openshift/templates/images/nginx/docker

<span class="token comment"># Verify image</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> bcgovgdx/wordpress-nginx-run <span class="token function">sh</span>
</code></pre></div><h3 id="mariadb" tabindex="-1"><a class="header-anchor" href="#mariadb"><span>MariaDB</span></a></h3><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># Build the image</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span> bcgovgdx/wordpress-mariadb-run <span class="token punctuation">\\</span>
            <span class="token parameter variable">-f</span> openshift/templates/images/mariadb/docker/Dockerfile <span class="token punctuation">\\</span>
            ./openshift/templates/images/mariadb/docker
</code></pre></div><h3 id="wordpress" tabindex="-1"><a class="header-anchor" href="#wordpress"><span>WordPress</span></a></h3><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># Build the image</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span> bcgovgdx/wordpress-wordpress-run <span class="token punctuation">\\</span>
            <span class="token parameter variable">-f</span> openshift/templates/images/wordpress/docker/Dockerfile <span class="token punctuation">\\</span>
            ./openshift/templates/images/wordpress/docker
</code></pre></div><h3 id="sidecar" tabindex="-1"><a class="header-anchor" href="#sidecar"><span>Sidecar</span></a></h3><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># Build the image</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span> bcgovgdx/wordpress-sidecar-run <span class="token punctuation">\\</span>
            <span class="token parameter variable">-f</span> openshift/templates/images/sidecar/docker/Dockerfile <span class="token punctuation">\\</span>
            ./openshift/templates/images/sidecar/docker
</code></pre></div><h3 id="plugin-themes" tabindex="-1"><a class="header-anchor" href="#plugin-themes"><span>Plugin / themes</span></a></h3><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># Build the image</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span> bcgovgdx/wordpress-plugins-themes <span class="token punctuation">\\</span>
            <span class="token parameter variable">-f</span> openshift/templates/images/plugins_themes/Dockerfile <span class="token punctuation">\\</span>
            ./openshift/templates/images/plugins_themes/
</code></pre></div>`,14),x={class:"custom-container warning"},y=e("p",{class:"custom-container-title"},"WARNING",-1),w={href:"https://hub.docker.com/search?q=bcgovgdx",target:"_blank",rel:"noopener noreferrer"},D=e("strong",null,"NOT",-1),B=e("div",{class:"custom-container tip"},[e("p",{class:"custom-container-title"},"TIP"),e("p",null,"All commands are given from the root of this repository")],-1);function N(P,I){const a=i("ExternalLinkIcon");return o(),r("div",null,[d,e("p",null,[e("a",p,[s("Kustomize"),n(a)]),s(" is a standalone tool to customize Kubernetes objects through a kustomization file, that ships with both OC and kubectl deployment utilities. To make local deployments more seamless, all images are being pulled from DockerHub "),e("a",h,[s("bcgovgdx namespace"),n(a)]),s(", alternatively you can "),u]),m,e("ul",null,[g,b,k,e("li",null,[s("you can now run "),e("a",v,[s("wp cli"),n(a)]),s(" commands, however locally this container is running in root so you will have to use the --allow-root flag")]),f]),_,e("div",x,[y,e("p",null,[s("Images that come from "),e("a",w,[s("bcgovgdx namespace"),n(a)]),s(" should "),D,s(" be used in production deployments.")])]),B])}const S=l(c,[["render",N],["__file","deploy_kubernetes.html.vue"]]),T=JSON.parse(`{"path":"/guide/GettingStarted/deploy_kubernetes.html","title":"Deploying WordPress to Kubernetes","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"Prerequisites","slug":"prerequisites","link":"#prerequisites","children":[]},{"level":2,"title":"Deploy","slug":"deploy","link":"#deploy","children":[]},{"level":2,"title":"The Deployment","slug":"the-deployment","link":"#the-deployment","children":[{"level":3,"title":"Access the sidecar","slug":"access-the-sidecar","link":"#access-the-sidecar","children":[]}]},{"level":2,"title":"Delete Deployment","slug":"delete-deployment","link":"#delete-deployment","children":[]},{"level":2,"title":"Building Images","slug":"building-images","link":"#building-images","children":[{"level":3,"title":"Nginx","slug":"nginx","link":"#nginx","children":[]},{"level":3,"title":"MariaDB","slug":"mariadb","link":"#mariadb","children":[]},{"level":3,"title":"WordPress","slug":"wordpress","link":"#wordpress","children":[]},{"level":3,"title":"Sidecar","slug":"sidecar","link":"#sidecar","children":[]},{"level":3,"title":"Plugin / themes","slug":"plugin-themes","link":"#plugin-themes","children":[]}]}],"git":{"contributors":[{"name":"Richard O'Brien","email":"122112933+robrien-bcgov@users.noreply.github.com","commits":1}]},"filePathRelative":"guide/GettingStarted/deploy_kubernetes.md"}`);export{S as comp,T as data};
