<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.7" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <title>Local development with WordPress | WordPress Deployments</title><meta name="description" content="Setup process for local development of Wordpress using Docker.">
    <link rel="preload" href="/wordpress/assets/style-CU5NSxZd.css" as="style"><link rel="stylesheet" href="/wordpress/assets/style-CU5NSxZd.css">
    <link rel="modulepreload" href="/wordpress/assets/app-B3dtpaZK.js"><link rel="modulepreload" href="/wordpress/assets/deploy_locally.html-Ckjb1kNQ.js">
    <link rel="prefetch" href="/wordpress/assets/index.html-DXNP3MBT.js" as="script"><link rel="prefetch" href="/wordpress/assets/building_images.html-D4Bt786k.js" as="script"><link rel="prefetch" href="/wordpress/assets/deploy_kubernetes.html-Bscbk7Jg.js" as="script"><link rel="prefetch" href="/wordpress/assets/deploy_openshift.html-D8DiL29h.js" as="script"><link rel="prefetch" href="/wordpress/assets/404.html-BulxF0Z2.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/wordpress/"><!----><span class="site-name can-hide" aria-hidden="true">WordPress Deployments</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/wordpress/" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/bcgov/wordpress" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/wordpress/" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/bcgov/wordpress" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">Getting Started <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link route-link-active sidebar-item active" href="/wordpress/guide/GettingStarted/deploy_locally.html" aria-label="Local development with WordPress"><!--[--><!--]--> Local development with WordPress <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/wordpress/#setup" aria-label="Setup"><!--[--><!--]--> Setup <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/wordpress/#environment-basics" aria-label="Environment Basics"><!--[--><!--]--> Environment Basics <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/wordpress/#setting-up-ssl-on-mac-required" aria-label="Setting up SSL on Mac (required)"><!--[--><!--]--> Setting up SSL on Mac (required) <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/wordpress/#run-docker-compose" aria-label="Run Docker compose"><!--[--><!--]--> Run Docker compose <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/wordpress/#optional-multi-site-recommended" aria-label="Optional multi-site (Recommended):"><!--[--><!--]--> Optional multi-site (Recommended): <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/wordpress/#running-thereafter" aria-label="Running Thereafter:"><!--[--><!--]--> Running Thereafter: <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/wordpress/#helper-functions" aria-label="Helper functions."><!--[--><!--]--> Helper functions. <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/wordpress/#including-helper-functions-in-bash-profile" aria-label="Including helper functions in bash profile."><!--[--><!--]--> Including helper functions in bash profile. <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/wordpress/#example-wordpress-command-line-using-wp" aria-label="Example WordPress Command Line using wp."><!--[--><!--]--> Example WordPress Command Line using wp. <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/wordpress/#backing-up-full-database" aria-label="Backing up full database"><!--[--><!--]--> Backing up full database <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/wordpress/#restoring-full-database" aria-label="Restoring full database"><!--[--><!--]--> Restoring full database <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/wordpress/guide/GettingStarted/deploy_kubernetes.html" aria-label="Deploying WordPress to Kubernetes"><!--[--><!--]--> Deploying WordPress to Kubernetes <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/wordpress/guide/GettingStarted/deploy_openshift.html" aria-label="Deploying WordPress to OpenShift"><!--[--><!--]--> Deploying WordPress to OpenShift <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/wordpress/guide/GettingStarted/building_images.html" aria-label="Building Images"><!--[--><!--]--> Building Images <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="deploying-wordpress-to-docker" tabindex="-1"><a class="header-anchor" href="#deploying-wordpress-to-docker"><span>Deploying WordPress to Docker</span></a></h1><h2 id="setup" tabindex="-1"><a class="header-anchor" href="#setup"><span>Setup</span></a></h2><p>Clone this repository, and go to the dev directory</p><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># Clone WordPress deployment repository</span>
<span class="token function">git</span> clone https://github.com/bcgov/wordpress.git
<span class="token comment"># Change directory to the wordpress/dev folder</span>
<span class="token builtin class-name">cd</span> wordpress/dev
<span class="token comment"># Create an .env by copying the sample .env</span>
<span class="token function">cp</span> sample-env .env
</code></pre></div><h2 id="environment-basics" tabindex="-1"><a class="header-anchor" href="#environment-basics"><span>Environment Basics</span></a></h2><ul><li>Update variables inside <code>.env</code> file to reflect your setup. <ul><li>The <code>CONTENT_DIR</code> variable is the location of your WordPress content directory.</li><li>The <code>TEMP_DIR</code> variable can be used to import/export db using the wp-cli command.</li></ul></li></ul><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>When Importing and Exporting databases with the <code>wp cli</code> This will be the link between the WordPress container and your local machine.</p></div><h2 id="setting-up-ssl-on-mac-required" tabindex="-1"><a class="header-anchor" href="#setting-up-ssl-on-mac-required"><span>Setting up SSL on Mac (required)</span></a></h2><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># sets up `localhost` self signed certs.</span>
<span class="token function">docker</span> compose <span class="token parameter variable">--file</span> docker-compose-init.yaml run self-signed-certificate-generator
</code></pre></div><ul><li>Drag ./Docker/nginx/ssl/localhost.crt to KeyChain app (login) section and trust always: <ul><li>Double-click the certificate.</li><li>Next to Trust, click the arrow and in the dropdown box for &quot;When using this certificate:&quot; select <code>Always Trust</code>.</li></ul></li><li>If this cert is not working, try restarting your MAC, however there might be a less drastic way of making this work.</li></ul><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>WordPress will now run on localhost port 443, which is exactly the same port that Kubernetes runs on. Therefore local Kubernetes and WordPress can&#39;t be running at the same time.</p></div><img src="/wordpress/images/keychain-localhost.png" style="max-width:250px;margin:1rem 0;"><h2 id="run-docker-compose" tabindex="-1"><a class="header-anchor" href="#run-docker-compose"><span>Run Docker compose</span></a></h2><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>You have to be in the wordpress/dev directory for this to work</p></div><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># Starts WordPress deployment </span>
<span class="token function">docker</span> compose up
<span class="token comment"># to re-build the images and start WordPress deployment</span>
<span class="token comment"># The build flag is required, anytime there are changes to the images.</span>
<span class="token function">docker</span> compose up <span class="token parameter variable">--build</span>
<span class="token comment"># If you enable build in shell scripts, this scripts works from anywhere</span>
<span class="token comment"># Starts WordPress deployments</span>
wp_start
</code></pre></div><ul><li>Access Wordpress at <a href="https://localhost" target="_blank" rel="noopener noreferrer">https://localhost<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Access PHPMyAdmin at <a href="http:/localhost:8081">http://localhost:8081</a> (Note: does not use https)</li></ul><h2 id="optional-multi-site-recommended" tabindex="-1"><a class="header-anchor" href="#optional-multi-site-recommended"><span>Optional multi-site (Recommended):</span></a></h2><ul><li><p>In the WordPress admin UI, go to menu Tools -&gt; Network Setup and click install</p></li><li><p>Bring down the WordPress site <code>docker compose down</code> (or &lt;CTRL&gt;-C if docker is in the foreground and then <code>docker compose down</code>).</p></li><li><p>In your <code>.env</code> file, ensure</p><ul><li><code>MULTISITE=1</code></li></ul></li><li><p>Bring up WordPress site <code>docker compose up</code></p></li><li><p>In the WordPress admin UI, go to My Sites -&gt; Network Admin -&gt; Settings and <code>change Max upload file size</code> to 10000 and click <code>Save Changes</code></p></li></ul><img src="/wordpress/images/max-upload-file-size.png" style="max-width:250px;margin:1rem 0;"><h2 id="running-thereafter" tabindex="-1"><a class="header-anchor" href="#running-thereafter"><span>Running Thereafter:</span></a></h2><ul><li><p><code>docker compose up</code> runs the nginx, db, WordPress php-fpm, and wp-cli containers, this will also output debug.log in the stdout.</p></li><li><p>WordPress wp-content directory, can be found at the path specified in your <code>.env</code> under variable <code>CONTENT_DIR</code>, .</p></li></ul><h2 id="helper-functions" tabindex="-1"><a class="header-anchor" href="#helper-functions"><span>Helper functions.</span></a></h2><p>The <a href="./bin/commands.sh">Helper functions</a> can be linked to run anytime a new terminal window is open by adding it to your <code>~/.bash_profile</code></p><h3 id="including-helper-functions-in-bash-profile" tabindex="-1"><a class="header-anchor" href="#including-helper-functions-in-bash-profile"><span>Including helper functions in bash profile.</span></a></h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>In order to make the helper functions accessible you need to include them into your bash or zsh profile. These commands then can be run from anywhere on your file system from a terminal window.</p></div><p>If you are using bash add this to your <code>~/.bash_profile</code></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /location-of-this-repo/wordpress/dev/bin/commands.sh <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
 <span class="token builtin class-name">.</span> /location-of-this-repo/wordpress/dev/bin/commands.sh
<span class="token keyword">fi</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Once this is done you can use the following commands from any directory</p><ul><li><code>wp_start</code> - Starts WordPress local deployment (docker)</li><li><code>wp_stop</code> - Stops WordPress local deployment (docker)</li><li><code>wp_log</code> - Tails the debug.log in the content directory</li><li><code>gowp</code> - Goes to plugin directory</li><li><code>gowp themes</code> - Goes to themes directory</li><li><code>wpgrep</code> - Does a grep with certain excludes to directories like .git, node_modules, vendor</li><li><code>wp</code> - <a href="https://wp-cli.org/" target="_blank" rel="noopener noreferrer">Wordpress Command line<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> that allows an endless amount of things to be completed with your local WordPress instance.</li></ul><h2 id="example-wordpress-command-line-using-wp" tabindex="-1"><a class="header-anchor" href="#example-wordpress-command-line-using-wp"><span>Example WordPress Command Line using wp.</span></a></h2><ul><li><code>wp site list</code> - Shows all the sites.</li><li><code>wp plugin list</code> - gets all the plugins.</li><li><code>wp plugin update akismet</code> - updates akismet plugin</li></ul><h2 id="backing-up-full-database" tabindex="-1"><a class="header-anchor" href="#backing-up-full-database"><span>Backing up full database</span></a></h2><p>This file will get stored in a directory that you determined in your <code>.env</code> as the <code>TEMP_DIR</code> variable.</p><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># In order for this command to work you need the following in your terminal profile (bash or zsh)</span>
<span class="token comment"># . /location-of-this-repo/wordpress/dev/bin/commands.sh as shown above</span>
wp db <span class="token builtin class-name">export</span> /tmp/WordPress/all-sites.sql --add-drop-table
</code></pre></div><h2 id="restoring-full-database" tabindex="-1"><a class="header-anchor" href="#restoring-full-database"><span>Restoring full database</span></a></h2><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>This command will replace your entire database, before running <code>wp db import</code> make sure you understand what this command does.</p></div><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code>wp db <span class="token function">import</span> /tmp/WordPress/all-sites.sql
</code></pre></div></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 45861534+ShawnTurple@users.noreply.github.com">Shawn</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav" aria-label="page navigation"><p class="inner"><!----><span class="next"><a class="route-link" href="/wordpress/guide/GettingStarted/deploy_kubernetes.html" aria-label="Deploying WordPress to Kubernetes"><!--[--><!--]--> Deploying WordPress to Kubernetes <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/wordpress/assets/app-B3dtpaZK.js" defer></script>
  </body>
</html>
